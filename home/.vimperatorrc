" Disable beep
beep off
set noerrorbells
set ignorecase
set smartcase
set complete=sl
set hintchars=abcdefghijklmnopqrstuvwxyz
set defsearch=google
set focuscontent

" Swap ; and : for US keyboard
nnoremap ; :
nnoremap : ;
vnoremap ; :
vnoremap : ;

" From undolist
nnoremap U :undo<Space>

" Tab navigation
nnoremap <C-n> gt
nnoremap <C-p> gT
nnoremap <C-w>t :<C-u>tabnew<CR>
nnoremap <C-w>q :<C-u>tabclose<CR>

" Command-line navigation
cnoremap <C-n> <Tab>
cnoremap <C-p> <S-Tab>

" Faster scroll
nnoremap j 5<C-e>
nnoremap k 5<C-y>

" Select all via <C-/> like Emacs
noremap <C-/> i<C-a>
inoremap <C-/> <insert><C-a><insert>

" Restart/Reconfigure
nnoremap ,,<C-r> :<C-u>restart<CR>
nnoremap ,,r :<C-u>source ~/.vimperatorrc<CR>

" Google with 's'
nnoremap s :<C-u>tabopen<Space>google<Space>
nnoremap S <C-c>:tabopen<Space>google<Space><C-v><CR>
vnoremap S <C-c><Esc><Esc>:tabopen<Space>google<Space><C-v><CR>

" Enlarge hit text
highlight Hint -append font-size:15px;

" Disable IME on command mode
style! -name=commandline-ime chrome://* #liberator-commandline-command input {ime-mode: inactive;}

" next/previous pattern for Japanese
set nextpattern=\bnext\b,\bmore\b,next,^次(の)?ページ,\b次.*,→\b,^>$,^(>>|≫)$,^(>|≫),(>|≫)$
set previouspattern=\bprev|previous\b,prev,^前(の)?ページ,\b前.*,\b←,^<$,^(<<|≪)$,^(<|≪),(<|≪)$

" qmarks
:qmark g https://github.com/lambdalisue
:qmark h http://b.hatena.ne.jp
:qmark t https://twitter.com
:qmark l http://lingr.com

" Automatically disable vimperator
ignorekeys clear
ignorekeys add localhost:8888
ignorekeys add nup-lpmns
ignorekeys add karyo-lpmns

" http://qiita.com/t3kot3ko/items/1b032940dbb79e88323e
javascript <<EOM
liberator.modules.commands.addUserCommand(["togglepin"], "add pin to current tab",
function(){
    var currentTab = gBrowser.mCurrentTab
    if(currentTab.pinned){
        gBrowser.unpinTab(currentTab)
    }
    else{
        gBrowser.pinTab(currentTab)
    }
});
EOM
nnoremap = :togglepin<CR>

" Use a correct application to open an external editor
javascript <<EOF
if (liberator.has("MacUnix")) {
    liberator.execute(
        "set editor='/Applications/MacVim.app/Contents/MacOS/MacVim -g -c \"set ft=markdown\" -f '"
    )
}
else {
    liberator.execute(
        "set editor='gnome-terminal --hide-menubar --disable-factory --geometry=119x57 --execute nvim -c \"set ft=markdown\" '"
    )
}
EOF

source! ~/.vimperatorrc.local
echomsg '~/.vimperatorrc has loaded.'
